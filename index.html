<!doctype html>
<html>
	<head>
		<title>picture-resize</title>
		<link href="css/picture-resize.css" type="text/css" rel="stylesheet" />
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js" type="text/javascript"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js" type="text/javascript"></script>		
		<script src="js/picture-resize.js" type="text/javascript"></script>
	</head>
	<body>
		<div class="container" style="width: 50%; height: 500px; margin: auto;"></div>
		<div class="action" style="text-align:center; margin-top: 30px"><button>View Result</button></div>
		<script type="text/javascript">
			!function(a){"use strict";var b=a.HTMLCanvasElement&&a.HTMLCanvasElement.prototype,c=a.Blob&&function(){try{return Boolean(new Blob)}catch(a){return!1}}(),d=c&&a.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(a){return!1}}(),e=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder||a.MSBlobBuilder,f=(c||e)&&a.atob&&a.ArrayBuffer&&a.Uint8Array&&function(a){var b,f,g,h,i,j;for(b=a.split(",")[0].indexOf("base64")>=0?atob(a.split(",")[1]):decodeURIComponent(a.split(",")[1]),f=new ArrayBuffer(b.length),g=new Uint8Array(f),h=0;h<b.length;h+=1)g[h]=b.charCodeAt(h);return i=a.split(",")[0].split(":")[1].split(";")[0],c?new Blob([d?g:f],{type:i}):(j=new e,j.append(f),j.getBlob(i))};a.HTMLCanvasElement&&!b.toBlob&&(b.mozGetAsFile?b.toBlob=function(a,c,d){a(d&&b.toDataURL&&f?f(this.toDataURL(c,d)):this.mozGetAsFile("blob",c))}:b.toDataURL&&f&&(b.toBlob=function(a,b,c){a(f(this.toDataURL(b,c)))})),"function"==typeof define&&define.amd?define(function(){return f}):a.dataURLtoBlob=f}(window);
			
			$(document).ready(function()
			{
				$('div.container').pictureResize({ width : 250, height : 250, size : 3 });
				$('div.action > button').on('click', function()
				{
					$('div.container').pictureResize('getResult', function(file, blob)
					{
						var reader = new FileReader();
							reader.onloadend = function(e)
							{
								window.open(e.target.result);
							}
							reader.readAsDataURL(blob);
					});
				});
			});
		</script>
	</body>
</html>